<script type="text/javascript" src="state_countryjs.asp"></script>
<style>
.overlay {
	/*background-image: url(assets/templates/common/images/transparent.png);*/
	background-color: #fff;
	filter: alpha(opacity=80);	/* Transparency */
	opacity: 0.8;	/* Transparency */
}
#overlay {
	background-image: url(assets/templates/common/images/transparent.png);
}
* html #overlay {
	background-image: url(assets/templates/common/images/pixel_trans.gif);
 filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src="assets/templates/common/images/transparent.png", sizingMethod="scale");
}
#simplemodal-overlay { background-color: #000; }
</style>
<script type="text/javascript" src="assets/templates/common/js/checkoutValidate.js" ></script>
<script type="text/javascript">
	useAddressValidator = "[useAddressValidator]";
	ccNumerNotAllowedMessage = '[ccNumerNotAllowedMessage]';
	sfname = "[shipping_firstname]";
	addLoadEvent(initpage);
</script>
<center>
  <form action="checkout_one.asp" method="post" name="billing" id="billing">
    <input type="hidden" name="tknio" value="[tknio]">
	<input type="hidden" name="k" id="k" value="[wallet_key_encoded]" />
	<input type="hidden" name="wid" id="wid" value="[wallet_id]" />
    <div id="billing_div" style="width:100%;">
      <table width="98%" cellpadding="0" cellspacing="6" border="0">
        <tr>
          <td colspan="2"><div id="divCart" style="width:100%;"> 
              <!--START: SHOPPING_CART_TEMP-->
              <table cellpadding="0" cellspacing="0" border="0" width="100%">
                <tr>
                  <td class="page_headers" align="left" colspan="5">One Page Checkout</td>
                </tr>
                <tr>
                  <td height="10" colspan="5"><img src="assets/templates/common/images/spacer.gif" alt="" width="1" height="10" /></td>
                </tr>
                <!--START: CATEGORY_HEADER-->
                <tr>
                  <td height="10" colspan="5"><table width="100%" cellspacing="0" cellpadding="2" border="0">
                      <tr>
                        <td class="data">[CONTENT]</td>
                      </tr>
                    </table></td>
                </tr>
                <tr>
                  <td height="10" colspan="5"><img src="assets/templates/common/images/spacer.gif" alt="" width="1" height="10" /></td>
                </tr>
                <!--END: CATEGORY_HEADER-->
                <tr>
                  <td class="titles2" align="left" colspan="2" width="10%"><strong>[shoppingcart_items]</strong></td>
                  <td class="titles2" align="center"><strong>[shoppingcart_quantity]</strong></td>
                  <td class="titles2" align="right"><strong>[shoppingcart_price]</strong></td>
                  <td class="titles2" align="right"><strong>[shoppingcart_total]</strong></td>
                </tr>
                <tr>
                  <td height="1" colspan="5" class="borders"><img src="assets/templates/common/images/spacer.gif" height="1"></td>
                </tr>
                <!--START: SHOPPING_CART_ITEM-->
                <tr>
                  <td width="15%" height="60" valign="middle"><!--START: itemthumbnail--><a href="product.asp?itemid=[ITEM_CATALOGID]"><img src="thumbnail.asp?file=[THUMBNAIL]" border="0" height="55" width="55" id="tl"></a><!--END: itemthumbnail--> 
                    <!--START: thumbnailnolink--><img src="thumbnail.asp?file=[THUMBNAIL]" border="0" height="55" width="55" id="tnl"><!--END: thumbnailnolink--></td>
                  <td class="item" valign="middle" align="left" width="55%"><!--START: itemnamelink--><a href="product.asp?itemid=[ITEM_CATALOGID]">[ITEM_NAME]</a><!--END: itemnamelink--> 
                    <!--START: itemnamenolink--><span id="spnItemName">[ITEM_NAME]</span><!--END: itemnamenolink--> 
                    <!--<a href="product.asp?itemid=[ITEM_CATALOGID]">[ITEM_NAME]</a> --> 
                    <!--START: itemoptions--> 
                    <br />
                    <a href='#' onClick="toggleProdOptions('opt[ITEM_ID]')">View/Hide options</a><br />
                    <div id=opt[ITEM_ID] name=opt[ITEM_ID] style="display:none;">[OPTIONS]</div>
                    
                    <!--END: itemoptions--> 
                    <!--START: recurring_frequency--> 
                    <br />
                    This item will Autoship every <b>[recurring_frequency]</b> 
                    <!--END: recurring_frequency--></td>
                  <td valign="middle" class="item" align="center">[ITEM_QUANTITY]
                    <input type="hidden" name="coliditemnum" value="[ITEM_ID]" size="3" maxlength="5" id="Hidden3" /></td>
                  <td valign="middle" class="item" align="right">[ITEM_PRICE]</td>
                  <td valign="middle" class="item" align="right">[ITEM_SUBTOTAL]</td>
                </tr>
                <tr>
                  <td height="1" colspan="6" class="borders"><img src="assets/templates/common/images/spacer.gif" height="1"></td>
                </tr>
                <!--END: SHOPPING_CART_ITEM-->
              </table>
              
              <!--END: SHOPPING_CART_TEMP--> 
            </div></td>
        </tr>
        <!--START: account_login1-->
        <tr>
          <td colspan="2"><table width="100%" cellpadding="0" cellspacing="4" class="alternative">
              <tr>
                <td class="item"> [checkout1_loginmessage2] <br />
                  <br />
                  <div style="float: left;">
                    <input type="button" value="[checkout1_login]" name="B3" onclick="document.location='checkout.asp?step=log-in';" class="btn" onmouseover="this.className='btn_over'" onmouseout="this.className='btn'" />
                  </div>
                  
                  <!--START: fbconnect-->
                  
                  <div style="float: left; margin: 2px 8px; padding: 0px;"><a onclick="popup('social_login.asp?p=fl&return=checkout',1000,550)" href="#" title="Sign in with Facebook"><img src="assets/templates/common/images/facebook_signin.png" alt="Sign in with Facebook" width="150" height="22" border="0" /></a></div>
                  
                  <!--END: fbconnect--></td>
              </tr>
            </table></td>
        </tr>
        <!--END: account_login1-->
        <tr>
          <td colspan="2">&nbsp;</td>
        </tr>
        <tr> 
          <!-- start left bar-->
          <td valign="top" width="50%"><table width="100%" cellpadding="0" cellspacing="0">
              <tr>
                <td colspan="2" class="checkout-headers"> [account_billing-info] </td>
              </tr>
              <tr>
                <td><div id="billing_info" style="width:100%">
                    <table width="100%" cellpadding="0" cellspacing="0">
                      <tr>
                        <td>
						<div id="divBillingInfo">
							<table style="width:100%" cellpadding="0" cellspacing="4" class="alternative">
								<tr><td class="item" align="right"><strong>[CustomerInfo_firstname]</strong></td><td class="datadisplay"><span id="spnBillingFirstName">[billing_firstname]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_lastname]</strong></td><td  class="datadisplay"><span id="spnBillingLastName">[billing_lastname]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_company]</strong></td><td class="datadisplay"><span id="spnBillingCompany">[billing_company]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_phone]</strong></td><td class="datadisplay"><span id="spnBillingPhone">[billing_phone]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_address]</strong></td><td class="datadisplay"><span id="spnBillingAddress">[billing_address]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_address2]</strong></td><td class="datadisplay"><span id="spnBillingAddress2">[billing_address2]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_city]</strong></td><td class="datadisplay"><span id="spnBillingCity">[billing_city]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_state]</strong></td><td class="datadisplay"><span id="spnBillingState">[billing_state]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_country]</strong></td><td class="datadisplay"><span id="spnBillingCountry">[billing_country]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_zip]</strong></td><td class="datadisplay"><span id="spnBillingZip">[billing_zip]</span></td></tr>
								<tr><td class="item" align="right"><strong>[CustomerInfo_email]</strong></td><td class="datadisplay"><span id="spnBillingEmail">[email]</span></td></tr>
								<tr><td colspan="2" style="text-align:center"><br />
								<input type="button" value="[checkout3_edit]" name="btnEditBilling" id="btnEditBilling" class="btn" onClick="editAddress('billing')" />
									</td></tr>

							</table>
						</div>
						<div id="billing_info2" style="width:100%; display:none;">
                            <table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                              <tr>
                                <td width="31%" align="right" class="item"><b>[CustomerInfo_firstname]</b></td>
                                <td nowrap><input name="billing_firstname" onChange="clearContent(this);" type="text" id="billing_firstname" value="[billing_firstname]" size="15" class="txtBoxStyle">
                                  
                                  <!--START: req_billing_firstname--> 
                                  <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                  <!--END: req_billing_firstname--></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_lastname]</b></td>
                                <td nowrap><input name="billing_lastname" type="text" onChange="clearContent(this);" id="billing_lastname" value="[billing_lastname]" size="15" class="txtBoxStyle">
                                  
                                  <!--START: req_billing_lastname--> 
                                  <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                  <!--END: req_billing_lastname--></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_company]</b></td>
                                <td><input name="billing_company" type="text" onChange="clearContent(this);" id="billing_company" value="[billing_company]" size="25" class="txtBoxStyle"></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_phone]</b></td>
                                <td nowrap><input name="billing_phone" type="text" maxlength="50" onChange="clearContent(this);" id="billing_phone" value="[billing_phone]" size="25" class="txtBoxStyle">
                                  
                                  <!--START: req_billing_phone--> 
                                  <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                  <!--END: req_billing_phone--></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_address]</b></td>
                                <td nowrap><input name="billing_address" type="text" onChange="clearContent(this);[po_box_disabled_billing]" id="billing_address" value="[billing_address]" size="25" class="txtBoxStyle">
                                  
                                  <!--START: req_billing_address--> 
                                  <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                  <!--END: req_billing_address--></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_address2]</b></td>
                                <td><input name="billing_address2" type="text" onChange="clearContent(this);" id="billing_address2" value="[billing_address2]" size="25" class="txtBoxStyle"></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_city]</b></td>
                                <td nowrap><input name="billing_city" type="text" onChange="clearContent(this);" id="billing_city" value="[billing_city]" size="25" class="txtBoxStyle">
                                  
                                  <!--START: req_billing_city--> 
                                  <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                  <!--END: req_billing_city--></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_country]</b></td>
                                <td nowrap><select name="billing_country" onChange="this.form.billing_zip.value='';populateState('billing_state','billing_country');check_stateValidator('billing');check_address('billing');" class="txtBoxStyle" id="billing_country">
                                  </select>
                                  
                                  <!--START: req_billing_country--> 
                                  <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                  <!--END: req_billing_country--></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_state]</b></td>
                                <td nowrap><span>
                                  <select id="billing_state" onChange="this.form.billing_zip.value='';check_address('billing');" name="billing_state" class="txtBoxStyle">
                                  </select>
                                  </span> 
                                  <!--START: req_billing_state--> 
                                  <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                  <!--END: req_billing_state--></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_zip]</b></td>
                                <td nowrap><input name="billing_zip" maxlength="15" type="text" id="billing_zip" value="[billing_zip]" size="10" class="txtBoxStyle" onChange="clearContent(this);check_address('billing');" >
                                  
                                  <!--START: req_billing_zip--> 
                                  <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                  <!--END: req_billing_zip--></td>
                              </tr>
                              <tr>
                                <td align="right" class="item"><b>[CustomerInfo_email]</b></td>
                                <td nowrap><input name="billing_email" type="text" id="billing_email" maxlength="50" onBlur="fillEmailDiv();" onKeyUp="fillEmailDiv();" onChange="clearContent(this);fillEmailDiv();updateOrderEmail();" value="[email]" size="25" class="txtBoxStyle">
                                  
                                  <!--START: emailrequired--> 
                                  <!--START: req_email--> 
                                  <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                  <!--END: req_email--> 
                                  <!--END: emailrequired--></td>
                              </tr>
                              <!--START: confirm_email-->
                              <tr>
                                <td colspan="2" align="center"><br /><input type="button" value="[checkout3_done]" name="btnEditBillingDone" id="btnEditBillingDone" class="btn" onClick="editAddress('billingdone')" /></td>
                              </tr>
                            </table>
                            <br />
                          </div>
						  <p><input type="checkbox" value="1" name="maillist" [maillist] id="Checkbox1" /> [checkout1_joinmailinglist]</p>


                        </td>
                      </tr>
                      <!--START: account_login2-->
                      <tr>
                        <td colspan="2" class="checkout-headers"> [checkout1_Header-createnewaccount] </td>
                      </tr>
                      <tr>
                        <td><table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                            <tr>
                              <td width="20%" align="right" class="item"><strong>[CustomerInfo_email]:</strong></td>
                              <td class="item"><div id="divEmail">&nbsp;[email]</div></td>
                            </tr>
                            <tr class="item">
                              <td align="right" class="item"><strong>[CustomerInfo_password]: </strong></td>
                              <td nowrap>

                                <table border="0" cellpadding="0" cellspacing="0">
                                    <tr>
	                                    <td style="width:1px">
                                            <input type="password" size="12" name="pass" class="txtBoxStyle" id="pass" autocomplete="off" [CallFunctionVerifyStrongPass]>
                                            <!--START: passwordrequired--> 
                                            <!--START: req_pass--> 
                                            <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                            <!--END: req_pass--> 
                                            <!--END: passwordrequired-->
                                        </td>
                                        <!--START: StrongPasswordBar-->
	                                    <td>
		                                    <div style="width:100px;height:10px;border:none;background-image: linear-gradient(to left, #00FF00 0%, #FF0000 100%);">
			                                <div id="divStrong" style="width:100%;height:10px;border:none;background-color:white;float:right"></div>
		                                    </div>
	                                    </td>
                                        <!--END: StrongPasswordBar-->
                                    </tr>
                                </table>
                              </td>
                            </tr>
                            <!--START: PasswordMSG-->
                            <tr><td></td><td class="item">[CustomerInfo_password_policy]</td></tr>
                            <!--END: PasswordMSG-->
                            <!--START: recurmessage-->
                            <tr>
                              <td colspan="2"><em class="error">[recurringorders_login-required]</em></td>
                            </tr>
                            <!--END: recurmessage-->
                            
                          </table>
                          <br /></td>
                      </tr>
                      <!--END: account_login2-->
                    </table>
                  </div></td>
              </tr>
            </table></td>
          <!-- end left bar--> 
          <!-- start right bar-->
          <td valign="top" align="right"><!--START: GIFT_REGISTRY_SHIPPING-->
            
            <input type="hidden" name="giftreg_shipping_firstname" id="giftreg_shipping_firstname" value="[giftreg_shipping_firstname]">
            <input type="hidden" name="giftreg_shipping_lastname" id="giftreg_shipping_lastname" value="[giftreg_shipping_lastname]">
            <input type="hidden" name="giftreg_shipping_company" id="giftreg_shipping_company" value="[giftreg_shipping_company]">
            <input type="hidden" name="giftreg_shipping_phone" id="giftreg_shipping_phone" value="[giftreg_shipping_phone]">
            <input type="hidden" name="giftreg_shipping_address" id="giftreg_shipping_address" value="[giftreg_shipping_address]">
            <input type="hidden" name="giftreg_shipping_address2" id="giftreg_shipping_address2" value="[giftreg_shipping_address2]">
            <input type="hidden" name="giftreg_shipping_city" id="giftreg_shipping_city" value="[giftreg_shipping_city]">
            <input type="hidden" name="giftreg_shipping_zip" id="giftreg_shipping_zip" value="[giftreg_shipping_zip]">
            <input type="hidden" name="giftreg_shipping_country" id="giftreg_shipping_country" value="[giftreg_shipping_country]">
            <input type="hidden" name="giftreg_shipping_state" id="giftreg_shipping_state" value="[giftreg_shipping_state]">
            <table width="97%" cellpadding="0" cellspacing="0">
              <tr>
                <td class="checkout-headers" colspan="2">[checkout1_Header-giftreg]</td>
              </tr>
              <tr>
                <td colspan="2" align="left"><table width="100%" cellpadding="3" cellspacing="0" class="alternative">
                    <tr>
                      <td colspan="2" class="item">[checkout1_Header-giftreg-instructions]</td>
                    </tr>
                    <tr>
                      <td colspan="2" class="item"><input type="button" id="cmdRegShip" onclick="javascript:selectGiftRegAddress();" name="cmdRegShip" value="Select Registry Address" class="btn"></td>
                    </tr>
                  </table>
                  <br /></td>
              </tr>
            </table>
            
            <!--END: GIFT_REGISTRY_SHIPPING-->
            
            <table width="97%" cellpadding="0" cellspacing="0">
              <tr class="checkout-headers">
                <td class="checkout-headers">[checkout1_Header-shippinginformation]</td>
                <!--START: sameAsBilling1-->
                <td class="checkout-headers" style="display:none; vertical-align:middle; width:130px"><input type="checkbox" value="ON" name="sameAsBilling" id="sameAsBilling" onClick="showHideShipping();check_address('');">
                  <span class="item" style="display:none;">[checkout3_sameasbilling]</span></td>
                <!--END: sameAsBilling1--> 
              </tr>
              <tr>
                <td colspan="3" align="right">
				<div id="divShippingInfo">
					<table style="width:100%" cellpadding="0" cellspacing="4" class="alternative">
						<tr><td class="item" align="right"><strong>[CustomerInfo_firstname]</strong></td><td class="datadisplay"><span id="spnShippingFirstName">[shipping_firstname]</span></td></tr>
						<tr><td class="item" align="right"><strong>[CustomerInfo_lastname]</strong></td><td  class="datadisplay"><span id="spnShippingLastName">[shipping_lastname]</span></td></tr>
						<tr><td class="item" align="right"><strong>[CustomerInfo_company]</strong></td><td class="datadisplay"><span id="spnShippingCompany">[shipping_company]</span></td></tr>
						<tr><td class="item" align="right"><strong>[CustomerInfo_phone]</strong></td><td class="datadisplay"><span id="spnShippingPhone">[shipping_phone]</span></td></tr>
						<tr><td class="item" align="right"><strong>[CustomerInfo_address]</strong></td><td class="datadisplay"><span id="spnShippingAddress">[shipping_address]</span></td></tr>
						<tr><td class="item" align="right"><strong>[CustomerInfo_address2]</strong></td><td class="datadisplay"><span id="spnShippingAddress2">[shipping_address2]</span></td></tr>
						<tr><td class="item" align="right"><strong>[CustomerInfo_city]</strong></td><td class="datadisplay"><span id="spnShippingCity">[shipping_city]</span></td></tr>
						<tr><td class="item" align="right"><strong>[CustomerInfo_state]</strong></td><td class="datadisplay"><span id="spnShippingState">[shipping_state]</span></td></tr>
						<tr><td class="item" align="right"><strong>[CustomerInfo_country]</strong></td><td class="datadisplay"><span id="spnShippingCountry">[shipping_country]</span></td></tr>
						<tr><td class="item" align="right"><strong>[CustomerInfo_zip]</strong></td><td class="datadisplay"><span id="spnShippingZip">[shipping_zip]</span></td></tr>
						<tr><td colspan="2" style="text-align:center"><br />
						<input type="button" value="[checkout3_edit]" name="btnEditShipping" id="btnEditShipping" class="btn" onClick="editAddress('shipping')" />
						    </td></tr>
					</table>
				</div>

				<div id="shipping_info" style="width:100%; display:none;">
                    <table width="100%" cellpadding="0" cellspacing="0">
                      <tr>
                        <td><!--START: sameAsBilling2-->
                          <table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                            <tr>
                            <tr>
                              <td width="30%" align="right" class="item"><b>[CustomerInfo_firstname]</b></td>
                              <td><input name="shipping_firstname" onChange="clearContent(this);" type="text" id="shipping_firstname" value="[shipping_firstname]" size="15" class="txtBoxStyle">
                                
                                <!--START: req_shipping_firstname--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_firstname--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_lastname]</b></td>
                              <td><input name="shipping_lastname" onChange="clearContent(this);" type="text" id="shipping_lastname" value="[shipping_lastname]" size="15" class="txtBoxStyle">
                                
                                <!--START: req_shipping_lastname--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_lastname--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_company]</b></td>
                              <td><input name="shipping_company" onChange="clearContent(this);" type="text" id="shipping_company" value="[shipping_company]" size="25" class="txtBoxStyle"></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_phone]</b></td>
                              <td nowrap><input name="shipping_phone" maxlength="50" onChange="clearContent(this);" type="text" id="shipping_phone" value="[shipping_phone]" size="25" class="txtBoxStyle">
                                
                                <!--START: req_shipping_phone--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_phone--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_address]</b></td>
                              <td nowrap><input name="shipping_address" onChange="clearContent(this);[po_box_disabled_shipping]" type="text" id="shipping_address" value="[shipping_address]" size="25" class="txtBoxStyle">
                                
                                <!--START: req_shipping_address--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_address--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_address2]</b></td>
                              <td nowrap><input name="shipping_address2" onChange="clearContent(this);" type="text" id="shipping_address2" value="[shipping_address2]" size="25" class="txtBoxStyle"></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_city]</b></td>
                              <td nowrap><input name="shipping_city" onChange="clearContent(this);" type="text" id="shipping_city" value="[shipping_city]" size="25" class="txtBoxStyle">
                                
                                <!--START: req_shipping_city--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_city--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_country]</b></td>
                              <td nowrap><select name="shipping_country" onChange="this.form.shipping_zip.value='';populateState('shipping_state','shipping_country');check_stateValidator('shipping');check_address('shipping');" class="txtBoxStyle" id="shipping_country">
                                </select>
                                
                                <!--START: req_shipping_country--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_country--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_state]</b></td>
                              <td nowrap><select id="shipping_state" onChange="this.form.shipping_zip.value='';check_address('shipping');" name="shipping_state" class="txtBoxStyle">
                                </select>
                                
                                <!--START: req_shipping_state--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_state--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_zip]</b></td>
                              <td nowrap><input name="shipping_zip" maxlength="15" type="text" id="shipping_zip" value="[shipping_zip]" size="10" class="txtBoxStyle" onChange="clearContent(this);check_address('shipping');" >
                                
                                <!--START: req_shipping_zip--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_zip--></td>
                            </tr>
							<tr>
                                <td colspan="2" align="center"><br /><input type="button" value="[checkout3_done]" name="btnEditShippingDone" id="btnEditShippingDone" class="btn" onClick="editAddress('shippingdone')" />
							</td>
							</tr>
                          </table>
                          <!--END: sameAsBilling2--> 
                          <!--START: sameAsBilling3-->
                          
                          <table width="100%" cellpadding="3" cellspacing="0" id="Table29">
                            <tr>
                              <td align="center" class="item"><br />
                                [checkout3_sameasbillingmessage]</strong></td>
                            </tr>
                          </table>
                          
                          <!--END: sameAsBilling3--> 
                          <br /></td>
                      </tr>
                    </table>
                  </div></td>
              </tr>
            </table></td>
          <!-- end right bar--> 
        </tr>
        <tr> 
          <!-- start left bar2-->
          <td valign="top" width="50%"><table width="100%" cellpadding="0" cellspacing="0">
              <tr>
                <td class="checkout-headers">[checkout3_Header-shippingmethodinfo]</td>
              </tr>
              <tr>
                <td>


				<!--START: echoFreightOptions-->
				<div id="divEchoOptions" style="display:none;">
					<table width="100%" cellpadding="0" cellspacing="0" id="Table6" border="0" class="alternative">
					<tr>
						<td class="item" align="left">
							<b>LTL Shipping Options:</b><br>
							1. Adjust these buttons for your shipping location.<br>
							2. Then click Refresh Rates below, and your new cost will show in Shipping (in the Order Total to the right).
							<br />
						</td>
					</tr>
					<tr>
						<td width="100%">
							<table width="100%" cellpadding="0" cellspacing="0" id="Table7">
								<!--
								<tr>
									<td><input type="radio" name="echoFreightOptions" value="19" onclick="document.getElementById('echoFreightOptionsBus1').checked = false; document.getElementById('echoFreightOptionsBus2').checked = false; document.getElementById('echoFreightOptionsRes1').checked = false; document.getElementById('echoFreightOptionsRes2').checked = false;" /></td>
									<td class="item">Construction Site</td>
								</tr>
								<<tr>
									<td><input type="radio" name="echoFreightOptions" value="20" onclick="document.getElementById('echoFreightOptionsBus1').checked = false; document.getElementById('echoFreightOptionsBus2').checked = false; document.getElementById('echoFreightOptionsRes1').checked = false; document.getElementById('echoFreightOptionsRes2').checked = false;" /></td>
									<td class="item">Trade Show or Convention Center</td>
								</tr>
								-->
								<tr>
									<td><input type="radio" name="echoFreightOptions" id="echoFreightOptionsBus" onclick="document.getElementById('echoFreightOptionsRes1').checked = false; document.getElementById('echoFreightOptionsRes2').checked = false;" value="22" /></td>
									<td class="item">Business</td>
								</tr>
								<tr>
									<td></td>
									<td>
										<table width="100%" cellpadding="0" cellspacing="0" id="Table12">
										<tr>
											<td valign="top"><input type="checkbox" name="echoFreightOptions" id="echoFreightOptionsBus1" onclick="document.getElementById('echoFreightOptionsBus').checked = true; document.getElementById('echoFreightOptionsRes').checked = false; document.getElementById('echoFreightOptionsRes1').checked = false; document.getElementById('echoFreightOptionsRes2').checked = false;" value="21" /></td>
											<td valign="top" class="item">Lift Gate required</td>
										</tr>
										<tr>
											<td valign="top"><input type="checkbox" name="echoFreightOptions" id="echoFreightOptionsBus2" onclick="document.getElementById('echoFreightOptionsBus').checked = true; document.getElementById('echoFreightOptionsRes').checked = false; document.getElementById('echoFreightOptionsRes1').checked = false; document.getElementById('echoFreightOptionsRes2').checked = false;" value="7" /></td>
											<td valign="top" class="item">The driver needs to deliver inside</td>
										</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td><input type="radio" checked name="echoFreightOptions" id="echoFreightOptionsRes" onclick="document.getElementById('echoFreightOptionsBus1').checked = false; document.getElementById('echoFreightOptionsBus2').checked = false;" value="18" /></td>
									<td class="item">Residential</td>
								</tr>
								<tr>
									<td></td>
									<td>
										<table width="100%" cellpadding="0" cellspacing="0" id="Table17">
										<tr>
											<td valign="top"><input type="checkbox" checked name="echoFreightOptions" id="echoFreightOptionsRes1" onclick="document.getElementById('echoFreightOptionsRes').checked = true; document.getElementById('echoFreightOptionsBus').checked = false; document.getElementById('echoFreightOptionsBus1').checked = false; document.getElementById('echoFreightOptionsBus2').checked = false;" value="21" /></td>
											<td valign="top" class="item">Lift Gate required</td>
										</tr>
										<tr>
											<td valign="top"><input type="checkbox" name="echoFreightOptions" id="echoFreightOptionsRes2" onclick="document.getElementById('echoFreightOptionsRes').checked = true; document.getElementById('echoFreightOptionsBus').checked = false; document.getElementById('echoFreightOptionsBus1').checked = false; document.getElementById('echoFreightOptionsBus2').checked = false;" value="7" /></td>
											<td valign="top" class="item">The driver needs to deliver inside</td>
										</tr>
										</table>
									</td>
								</tr>
								<!--<tr>
									<td><input type="checkbox" name="echoFreightOptions" value="14" /></td>
									<td class="item">Notify prior to delivery (to arrange the time and day)</td>
								</tr>-->
							</table>
						</td> 
					</tr>
				</table>
				<table width="100%" cellpadding="0" cellspacing="4" class="alternative">
					<tr>
						<td class="item" colspan="2"><a href="javascript:check_address('refresh');">[checkout3_refreshRates]</a></td>
					</tr>
				</table>
				</div>
				<!--END: echoFreightOptions-->


					
					<div id="shipping_div" style="width:100%;font-size:10pt;">
                    <table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                      <tr>
                        <td class="item"><div id="shipResult">
                            <p class="item">[checkout3_shippinginstructions]</P>
                          </div>
                          <a href="javascript:check_address('refresh');">[checkout3_refreshRates]</a></td>
                      </tr>
                    </table>
                  </div>
                  <br />



                </td>
              </tr>
            </table></td>
          <!-- end left bar2--> 
          <!-- start right bar2-->
          <td valign="top" align="right"><table width="95%" cellpadding="0" cellspacing="0">
              <tr>
                <td class="checkout-headers" colspan="3" valign="top">[checkout3_orderTotal]</td>
              </tr>
              <tr>
                <td colspan="3"><div id="total_div" name="total_div" style="width:100%;"> 
                    <!--START: total_template_noshipping-->
                    <table width="100%" cellpadding="0" cellspacing="2" id="Table30" border="0" class="alternative">
                      <tr>
                        <td height="15" style="font-size:10pt;"><p>[checkout3_totalinstructions]</p></td>
                      </tr>
                    </table>
                    <!--END: total_template_noshipping--> 
                    <!--START: total_template-->
                    <table width="100%" cellpadding="0" cellspacing="2" id="Table20" border="0" class="alternative">
                      <tr>
                        <td class="item"><strong>[itemCount] Item(s)</strong>:</td>
                        <td class="item" style="text-align:right;">[SUBTOTAL]</td>
                      </tr>
                      <!--START: DISCOUNTS-->
                      <tr>
                        <td class="item"><strong>[shoppingcart_discount]</strong>: <a href="javascript:showDiscountDetails();">(details)</a></td>
                        <td class="item" style="text-align:right;">- [DISCOUNT]</td>
                      </tr>
                      <!--START: PROMOTIONS-->
                      <tr>
                        <td colspan="2" align="center"><div id="divDiscountDetails" name="divDiscountDetails" style="width:100%;align:center;display:none;background:#efefef;">
                            <table width="100%" cellpadding="0" cellspacing="2" id="Table28" border="0">
                              <tr>
                                <td class="item"><b>Promotion Name</td>
                                <td class="item"></td>
                              </tr>
                              <!--START: DISPLAY_PROMOS-->
                              <tr>
                                <td class="item">[promotion_name]</td>
                                <td class="item" style="text-align:right;"><!--START: REMOVE_PROMO--><a href="javascript:removeCoupon('[id]');">remove</a><!--END: REMOVE_PROMO--></td>
                              </tr>
                              <!--END: DISPLAY_PROMOS-->
                            </table>
                          </div></td>
                      </tr>
                      <!--END: PROMOTIONS--> 
                      <!--END: DISCOUNTS--> 
                      <!--START: BUYSAFE-->
                      <tr>
                        <td class="item" ><img src="assets/templates/common/images/buysafe.gif" border="0"></td>
                        <td class="item" style="text-align:right;">[buysafe_totalbondcost]</td>
                      </tr>
                      <!--END: BUYSAFE--> 
                      <!--START: HANDLING-->
                      <tr>
                        <td class="item" ><strong>[handling_itemname]</strong>:</td>
                        <td class="item" style="text-align:right;">[handling_price]</td>
                      </tr>
                      <!--END: HANDLING-->
                      <tr>
                        <td class="item" ><strong>[shoppingcart_shipping]</strong>:</td>
                        <td class="item" style="text-align:right;">[SHIPPING]</td>
                      </tr>
                      <tr>
                        <td class="item"><strong>[shoppingcart_taxes]</strong>:</td>
                        <td class="item" style="text-align:right;">[TAX]</td>
                      </tr>
                      <tr>
                        <td class="item"><strong>[shoppingcart_total]</strong>:</td>
                        <td class="item" style="text-align:right;">[TOTAL]</td>
                      </tr>
                      <!--START: GIFTCERTS-->
                      <tr>
                        <td class="item" nowrap><strong>[shoppingcart_giftcertificate]</strong>: <a href="javascript:showGiftCertDetails();">(details)</a></td>
                        <td class="item" style="text-align:right;">-[GIFTCERTS]</td>
                      </tr>
                      <tr>
                        <td colspan="2" align="center"><div id="divGiftCertDetails" name="divGiftCertDetails" style="width:100%;align:center;display:none;background:#efefef;">
                            <table width="100%" cellpadding="0" cellspacing="2" id="Table26" border="0">
                              <tr>
                                <td class="item"><b>Gift Code</td>
                                <td class="item" style="text-align:right;"><b>Amount</td>
                                <td class="item" style="text-align:right;"><b>Balance</td>
                                <td class="item"></td>
                              </tr>
                              <!--START: GIFTCERTS_DETAILS_ITEMS-->
                              <tr>
                                <td class="item">[certificate_name]</td>
                                <td class="item" style="text-align:right;">[discount_amount]</td>
                                <td class="item" style="text-align:right;">[discount_balance]</td>
                                <td class="item" style="text-align:right;"><a href="javascript:removeCoupon('[id]');">remove</a></td>
                              </tr>
                              <!--END: GIFTCERTS_DETAILS_ITEMS-->
                            </table>
                          </div></td>
                      </tr>
                      <!--END: GIFTCERTS-->
                      <tr>
                        <td class="item" colspan="2"><hr></td>
                      </tr>
                      <tr>
                        <td class="item"><strong>[shoppingcart_balance]</strong>:</td>
                        <td class="item" style="text-align:right;"><span class="price">[BALANCE]</span></td>
                      </tr>
                      <tr>
                        <td class="item" colspan="2"><hr></td>
                      </tr>
                      <!--START: apply_coupon-->
                      <tr>
                        <td class="item" colspan="2"><table width="100%" border="0">
                            <tr>
                              <td class="item"><strong>[viewcart_coupon-header]:</strong></td>
                              <td nowrap><input id="coupon" onChange="clearContent(this);" maxlength="30" size="15" value="" name="coupon_code" />
                                <input type=button class="btn" onClick="applyCoupon(this.form.coupon_code.value);" value="Go!" /></td>
                            </tr>
                            <tr>
                              <td class="item" colspan="10">[viewcart_coupon-message]</td>
                            </tr>
                            <tr>
                              <td class="item" colspan="10"><div name="divInvalidCoupon" id="divInvalidCoupon" style="display:[invalidCouponDisplay];color:#f00;">[viewcart_coupon-invalid]</div>
                                [divCouponApplied] </td>
                            </tr>
                          </table></td>
                      </tr>
                      <!--END: apply_coupon-->
                    </table>
                    <!--END: total_template--> 
                  </div></td>
              </tr>
            </table></td>
          <!-- end right bar2--> 
        </tr>
        <tr>
          <td colspan="2"><div id="divPayment" style="width:100%"> 
              <!--START: PAYMENT_BLOCK-->
              <table border="0" width="100%" id="Table13">
                <tr>
                  <td class="checkout-headers">[checkout3_masterpass]</td>
                </tr>
                <!--START: NO_PAYMENT_BLOCK-->
                <tr>
                  <td class="item">There's no payment options available to your address. Please check the entered address and try again.</td>
                </tr>
                <!--END: NO_PAYMENT_BLOCK-->
                <tr>
                  <td><div style="width:100%">
                      <table width="50%" cellpadding="0" cellspacing="3" class="alternative" id="Table14">
                        
                        <!--START: CCGATEWAY-->
                        <tr>
                          <td class="titles" style="display:none;"><input onClick="javascript:checkoutSwitch(false);controlDivPayment('[id]');" name="payment" type="radio" value="online-[id]" id="Radio2" checked="checked">
                            &nbsp;Check out with MasterPass&tm;
                          </td>
                        </tr>
                        <tr>
                          <td class="item"><div id="divPaymentOption[id]" name="divPaymentOption" style="display:none;">
                              <table width="100%" cellpadding="0" cellspacing="3">
                                <tr>
                                  <td class="item" colspan="2">[payment_description_message]&nbsp;
								  <!--START: masterpassimage--><img src="https://www.mastercard.com/mc_us/wallet/img/mcpp_wllt_btn_chk_147x034px.png" alt="Buy With MasterPass&trade;" /><!--END: masterpassimage-->
								  <!--START: visacheckoutimage--><img src="[visacheckout_cardart]" alt="Buy With VISA Checkout" /><!--END: visacheckoutimage-->
                                  </td>
                                </tr>
                                <tr>
                                  <td class="item" align="right"><b>[CustomerInfo_creditcardnumber]:</b></td>
                                  <td><input type="hidden" name="ff[id]_ocardno" value="[ccnumberdata]" />
								  <input type="hidden" name="masterPass" value="1">
								  [ccnumberdisplay]
                                  </td>
                                </tr>
                                <tr>
                                  <td class="item" align="right"><b>[CustomerInfo_creditexpiration]:</b></td>
                                  <td class="item">[ccmonthdata]/[ccyeardata]	 
								  <input type="hidden" name="ff[id]_ocardexpiresmonth" value="[ccmonthdata]">
                                  <input type="hidden" name="ff[id]_ocardexpiresyear" value="[ccyeardata]">
	                             </td>
                                </tr>
                                <tr>
                                  <td class="item" align="right"><b>[CustomerInfo_cardtype]:</b></td>
                                  <td>
								  <input type="hidden" name="ff[id]_ocardtype" value="[cctypedata]" />
								  [cctypedata]
                                </tr>
                                <tr>
                                  <td colspan="2" class="item" align="right"><a href="checkout.asp" style="text-decoration:underline;">[checkout3_updatemethod]</a></td>
                                </tr>
                              </table>
                            </div></td>
                        </tr>
                        <!--END: CCGATEWAY--> 

                      </table>
                    </div></td>
                </tr>
              </table>
              <!--END: PAYMENT_BLOCK--> 
            </div>
            
            
            <br />
            <div id="divCheckoutQuestions" style="width:100%"> 
              <!--START: checkout_questions-->
              <table border="0" width="100%">
                <tr>
                  <td class="checkout-headers">[checkout1_checkoutquestions]</td>
                </tr>
                <tr>
                  <td ><table width="100%" cellpadding="2" cellspacing="0" class="alternative" id="Table3">
                      <tr>
                        <td><!--START: questions--> 
                          [questions] 
                          <!--END: questions--></td>
                      </tr>
                    </table></td>
                </tr>
              </table>
              <br />
              <!--END: checkout_questions--> 
            </div>
            <table border="0" width="100%">
              <tr>
                <td class="checkout-headers">[checkout3_Header-comment]</td>
              </tr>
              <tr>
                <td><table width="100%" cellpadding="4" cellspacing="0" class="alternative" id="Table19">
                    <tr>
                      <td class="item">[checkout3_commentmessage]</td>
                    </tr>
                    <tr>
                      <td><textarea onchange="clearContent(this);updateOrderComments(this.value);"  name="ocomment" class="txtBoxStyle" cols="55" rows="3"></textarea></td>
                    </tr>
                  </table></td>
              </tr>
              <tr>
                <td align="right"><div id="spanCheckout">
                    <div id="divCheckout" name="divCheckout" style="width:80%;display:none;background:#ffffff;border:0px solid black;text-align:center;padding:10px;"> <br />
                      Processing... </div>
                    <a name="checkoutButton"></a>
                    <input type="button" value="[checkout3_submitbutton]" name="btnCheckout" id="btnCheckout" class="btn" onClick="doCheckout(this.form);"/>
                  </div></td>
              </tr>
            </table></td>
        </tr>
        <tr>
          <td colspan="10"><!--START: CATEGORY_FOOTER-->
            
            <table width="100%" cellspacing="0" cellpadding="2" border="0">
              <tr>
                <td class="item">[CONTENT]</td>
              </tr>
            </table>
            
            <!--END: CATEGORY_FOOTER--></td>
        </tr>
      </table>
    </div>
  </form>
  <script>
  	window.setTimeout('showHideShipping_init()',100);

  	function showHideShipping_init()
  	{
  		var objBody = getElementById_s('shipping_info');	
  		var intWidth = objBody.clientWidth;
  		if (intWidth == 0)
  			window.setTimeout('showHideShipping_init()',100);
  		else
  			showHideShipping();
  	}
	
  	initCountry('[billing_country]','[billing_state_script]','billing_state','billing_country');
  	if (get_Element('shipping_state') != 'undefined' && get_Element('shipping_state') != null)
  		initCountry('[shipping_country]','[shipping_state_script]','shipping_state','shipping_country');
	
  	//Every time that there's no state for a selected country, that script deletes the state control and creates another one.
  	//That's why we need to re-create the validation for the state.
  	var billingStateType = document.billing.billing_state.type;
  	if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
  		var shippingStateType = document.billing.shipping_state.type;
	
  	function check_stateValidator(type)
  	{
  		if (type == 'billing')
  		{
  			if (document.billing.billing_state.type == 'select-one') //billingStateType)
  			{

  				frmvalidator.addValidation("billing_state","req","Please enter/select your billing state");
  				frmvalidator.addValidation("billing_state","maxlen=50");
  				billingStateType = document.billing.billing_state.type;
  			}
  		}
  		else
  		{
  			if (document.billing.shipping_state.type == 'select-one')
  			{
  				frmvalidator.addValidation("shipping_state","req","Please enter/select your shipping state");
  				frmvalidator.addValidation("shipping_state","maxlen=50");
  				shippingStateType = document.billing.shipping_state.type;
  			}		
  		}
  	}

  	function setValidation()
  	{
  		frmvalidator.clearAllValidations();
		
  		frmvalidator.addValidation("billing_firstname","req","Please enter your billing First Name");
  		frmvalidator.addValidation("billing_firstname","maxlen=20","Max length for billing First Name is 20");

  		frmvalidator.addValidation("billing_lastname","req","Please enter your billing Last Name");
  		frmvalidator.addValidation("billing_lastname","maxlen=20","Max length for billing Last Name is 20");

  		//<!--START: phonerequiredscript_billing-->
		frmvalidator.addValidation("billing_phone","maxlen=18","Max length for billing Phone is 18");
  		if (get_Element('billing_country') != 'undefined' && get_Element('billing_country') != null)
  			if (get_Element('billing_country').value == "US")
  				frmvalidator.addValidation("billing_phone","phone","Invalid phone number.");
  		frmvalidator.addValidation("billing_phone","req","Please enter your billing phone")
		//<!--END: phonerequiredscript_billing-->

		frmvalidator.addValidation("billing_address","maxlen=50");
  		frmvalidator.addValidation("billing_address","req","Please enter your billing address");

  		frmvalidator.addValidation("billing_city","maxlen=50");
  		frmvalidator.addValidation("billing_city","req","Please enter your billing city");

  		if (get_Element('billing_country').value == "US" || get_Element('billing_state').type == 'select-one')
		
  		{
  			frmvalidator.addValidation("billing_state","req","Please enter/select your billing state");
  			frmvalidator.addValidation("billing_state","maxlen=50");
  		}

  		frmvalidator.addValidation("billing_zip","maxlen=15");
  		frmvalidator.addValidation("billing_zip","req","Please enter your billing zip code");
		
  		//<!--START: emailrequiredscript-->
		frmvalidator.addValidation("billing_email","maxlen=50","Max length for Email is 50");
  		frmvalidator.addValidation("billing_email","req","Please enter your email address");
  		frmvalidator.addValidation("billing_email","email");		
  		//<!--END: emailrequiredscript-->
		
		//<!--START: confirmemailscript-->
		if (document.billing.billing_confirmemail != null && document.billing.billing_confirmemail != 'undefined')
  		{
  			frmvalidator.addValidation("billing_confirmemail","maxlen=50","Max length for Email is 50");
  			frmvalidator.addValidation("billing_confirmemail","req","Please confirm your Email.");
  			frmvalidator.addValidation("billing_confirmemail","email","Please confirm your Email.");
  			frmvalidator.setAddnlValidationFunction("confirmationValidation");
  		}
  		//<!--END: confirmemailscript-->

		//<!--START: passwordrequiredscript-->
		frmvalidator.addValidation("pass","maxlen=20");
  		frmvalidator.addValidation("pass","req","Please enter your new password (registration is required)");
  		//<!--END: passwordrequiredscript-->
				
		frmvalidator.addValidation("billing_country","dontselect=0");
				
  		if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
  			if (!document.billing.sameAsBilling.checked)
  			{
  				frmvalidator.addValidation("shipping_firstname","req","Please enter your shipping First Name");
  				frmvalidator.addValidation("shipping_firstname","maxlen=20","Max length for shipping First Name is 20");

  				frmvalidator.addValidation("shipping_lastname","req","Please enter your shipping Last Name");
  				frmvalidator.addValidation("shipping_lastname","maxlen=20","Max length for shipping Last Name is 20");
  				//<!--START: phonerequiredscript_shipping-->
				frmvalidator.addValidation("shipping_phone","maxlen=18","Max length for shipping Phone is 18");
  				if (get_Element('shipping_country') != 'undefined' && get_Element('shipping_country') != null)
  					if (get_Element('shipping_country').value == "US")
  						frmvalidator.addValidation("shipping_phone","phone","Invalid phone number.");
  				frmvalidator.addValidation("shipping_phone","req","Please enter your shipping phone")
				//<!--END: phonerequiredscript_shipping-->
				frmvalidator.addValidation("shipping_address","maxlen=50");
  				frmvalidator.addValidation("shipping_address","req","Please enter your shipping address");

  				frmvalidator.addValidation("shipping_city","maxlen=50");
  				frmvalidator.addValidation("shipping_city","req","Please enter your shipping city");

  				if (get_Element('shipping_country').value == "US" || get_Element('shipping_state').type == 'select-one')
  				{
  					frmvalidator.addValidation("shipping_state","req","Please enter/select your shipping state");
  					frmvalidator.addValidation("shipping_state","maxlen=50");
  				}

  				frmvalidator.addValidation("shipping_zip","maxlen=15");
  				frmvalidator.addValidation("shipping_zip","req","Please enter your shipping zip code");

  				frmvalidator.addValidation("shipping_country","dontselect=0");		
  			}
			
  	}
</script> 
  <script type="text/javascript">
  	//You should create the validator only after the definition of the HTML form
  	var frmvalidator = new Validator("billing");
  	frmvalidator.EnableMsgsTogether();

  	function confirmationValidation()
  	{
  		if(get_Element("billing_email").value != get_Element("billing_confirmemail").value)
  		{
  			alert('The Email does not match.');
  			return false;
  		}
  		return true;
  	}
</script> 
  
  <!--START: ELAYAWAYGATEWAYSCRIPTS--> 
  <script type="text/javascript" src="https://app2.elayaway.com/javascripts/prototype.js"></script> 
  <script type="text/javascript" src="https://app2.elayaway.com/javascripts/elayaway.js"></script> 
  <script>
  	function eLayAwayPost()
  	{
  		//Hide the calculator
  		var myDivCalculator = document.getElementById("elayaway_configurator0");
  		myDivCalculator.style.display = 'none';	
			
  		//Write the selected payment configuration
  		var myDivElayaway = document.getElementById("divElayawayInfo");
  		var intMonths = 0;
  		intMonths = eval(parseInt(document.eci_form.months.value)+1);
  		var myString = "Selected term: " + intMonths + " months";
  		myDivElayaway.innerHTML = myString;
			
  		document.eci_form.elayawayconfigured.value = "1";
  	}
		</script>
  <form name="eci_form" id="eci_form" method="POST" action="javascript:eLayAwayPost();">
    <input type="hidden" value="0" name="elayawayconfigured" id="elayawayconfigured"/>
    <input type="hidden" value="" name="months" id="months"/>
    <input type="hidden" value="" name="payment_frequency" id="payment_frequency"/>
  </form>
  <!--END: ELAYAWAYGATEWAYSCRIPTS--> 
  
  <!------------------------------------------------------------------------------> 
  <!-- BEGIN TEMPLATES BLOCKS --> 
  <!------------------------------------------------------------------------------> 
  <!--START: addressType-->
  <table width="100%" cellpadding="0" cellspacing="0" id="Table9">
    <tr>
      <td class="item" align="right" nowrap><b>[CustomerInfo_address_type]</b>&nbsp;</td>
      <td width="100%"><select name="shipping_addresstype" id="shipping_addresstype" class="txtBoxStyle" onChange="check_address('addresstype');">
          
          
					
				[addressTypeDropDown]
			
				
        
        </select></td>
    </tr>
  </table>
  <hr>
  <!--END: addressType--> 
  <!--START: CARRIER-->
  <table width="100%" cellpadding="0" cellspacing="0" id="Table24">
    <!--START: displayblock-->
    <tr>
      <td colspan="3"><div align="left"><img src="/assets/templates/common/images/[OPTION-SHIPPER].gif"></div></td>
      <td colspan="2" align="right"><a href="javascript:click_ship();" onClick="controlDivShipping('[OPTION-SHIPPER]');">Display Rates</a></td>
    </tr>
    <!--END: displayblock-->
    <tr>
      <td colspan="5"><div name="divShipping[OPTION-SHIPPER]" id="divShipping[OPTION-SHIPPER]" class="ship" style="display:none;">
          <table width="100%" cellpadding="0" cellspacing="0" border="0" id="Table25">
            <!--START: SHIPPING_OPTION-->
            <tr>
              <td><div align="right"></div></td>
              <td align="left"><input type="radio" name="shipping" value="[ID]" [SELECTED] id="radio_ship" onClick="select_shipping([ID]);"></td>
              <td class="item" align="left" width="200"><!--[OPTION-SHIPPER]--> 
                [OPTION-DESCRIPTION]</td>
              <td>&nbsp;</td>
              <td class="item" align="left">[OPTION-PRICE2]</td>
            </tr>
            <!--END: SHIPPING_OPTION-->
          </table>
        </div></td>
    </tr>
    <tr>
      <td class="borders" colspan="5"><img src="assets/templates/common/images/spacer.gif" width="100%" height="1"></td>
    </tr>
  </table>
  <!--END: CARRIER--> 
  
  <!--START: INSURANCE-->
  <div style="padding: 5px 0px 5px 0px;">
    <table border="0">
      <tr>
        <td class="checkout-headers">[checkout2_insurance]</td>
      </tr>
      <tr>
        <td><table width="100%" cellpadding="2" cellspacing="0" class="alternative">
            <tr>
              <td class="item" align="left"><input type="radio" name="insurance" value="yes" onclick="javascript:select_shipping(jQuery('input[name=shipping]:checked', '#billing').val());" [insurance_selected]>
                (+[insurance_cost]) [checkout2_insurance-selected] 
                <!--START: optional--> 
                <br />
                <input type="radio" name="insurance" onclick="javascript:select_shipping(jQuery('input[name=shipping]:checked', '#billing').val());" value="no" [no_insurance_selected]>
                [checkout2_insurance-not-selected] 
                <!--END: optional--></td>
            </tr>
          </table></td>
      </tr>
    </table>
  </div>
  <!--END: INSURANCE--> 
  
  <!--START: checkout_questions_templates--> 
  <!--START: textarea-format-->
  <table>
    <tr>
      <td align="right" class="item"><!--START: req[id]--> 
        <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
        <!--END: req[id]--> 
        <b>[question]</b></td>
      <td><textarea cols="30" rows="5" name="cq[id]" class="txtBoxStyle" id="Textarea1">[answer]</textarea></td>
    </tr>
  </table>
  <!--END: textarea-format--> 
  <!--START: text-format-->
  <table id="Table8">
    <tr>
      <td align="right" class="item"><!--START: req[id]--> 
        <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
        <!--END: req[id]--> 
        <b>[question]</b></td>
      <td><input type="text" size="30" name="cq[id]" value="[answer]" class="txtBoxStyle"></td>
    </tr>
  </table>
  <!--END: text-format--> 
  <!--START: checkbox-format-->
  <table id="Table10">
    <tr>
      <td><!--START: req[id]--> 
        <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
        <!--END: req[id]-->
        
        <input type="checkbox" name="cq[id]" class="txtBoxStyle" value="[answer]" [selected] id="Checkbox2"></td>
      <td align="right" class="item"><b>[question]</b></td>
    </tr>
  </table>
  <!--END: checkbox-format--> 
  <!--START: radio-format-->
  <table id="Table11">
    <tr>
      <td align="right" class="item"><!--START: req[id]--> 
        <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
        <!--END: req[id]--> 
        <b>[question]</b></td>
      <td><!--START: option-->
        
        <input type="radio" name="cq[id]" value="[option]" class="txtBoxStyle" [selected] id="Radio1">
        [option]<br />
        
        <!--END: option--></td>
    </tr>
  </table>
  <!--END: radio-format--> 
  <!--START: dropdown-format-->
  <table>
    <tr>
      <td align="right" class="item"><!--START: req[id]--> 
        <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
        <!--END: req[id]--> 
        <b>[question]</b></td>
      <td><select name="cq[id]" id="Select4">
          <!--START: option-->
          <option value="[option]" [selected]>[option]</option>
          <!--END: option-->
        </select></td>
    </tr>
  </table>
  <!--END: dropdown-format--> 
  <!--END: checkout_questions_templates-->
</center>

<!--START: verByVisa--> 
<script language="javascript" type="text/javascript">
	function openVerByVisa(strUrl) {
		//add_overlay("billing_div", 1);
		var elt = jQuery('#divVerByVisa');
		document.getElementById("iframeVisa").src = strUrl;

		// calculate the center of the page using the browser and element dimensions
		var y = (jQuery(document).height() - jQuery('#divVerByVisa').height()) / 2;
		var x = (jQuery(document).width() - jQuery('#divVerByVisa').width()) / 2;

		// set the style of the element so it is centered
		var styles = { position: 'absolute',
			top: y + 'px',
			left: x + 'px',
			display: 'block'
		};

		try
		{
			elt.css(styles);
			elt.scrollTo();
		}
		catch(err){}
	}
	function closeVerByVisa(bolDoCheckout, strMsg) {
		//remove_overlay("billing_div");
		var elt = jQuery('#divVerByVisa');
		var styles = { position: 'absolute',
			top: '0px',
			left: '0px',
			display: 'none'
		};
		elt.css(styles);
		document.getElementById("iframeVisa").src = "assets/images/spacer.gif";

		if (bolDoCheckout) {
			doCheckout(document.billing);
		}
		else {
			if (strMsg != "") {
				var objDiv = get_Element('divCheckout');
				objDiv.style.display = 'block';
				objDiv.innerHTML = strMsg;
			}
		}
	}
</script>
<div id="divVerByVisa" style="display:none;"> <br />
  <div style="background-color:#fff; text-align:right; border: 1px solid #ccc; box-shadow: 0 0 5px rgba(0, 0, 0, 0.4); -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.4); -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.4);"> <a href="#" onclick="javascript:closeVerByVisa();//window.location.reload();">close</a>&nbsp;&nbsp;
    <div style="text-align:center;">
      <iframe id="iframeVisa" name="iframeVisa" src="assets/images/spacer.gif" width="750" height="450" scrolling="no" frameborder="0"></iframe>
    </div>
  </div>
</div>
<!--END: verByVisa--> 

<!--START: paypaladvance-->
<form method="post" action="https://payflowlink.paypal.com" name="frmPayPalAdv" id="frmPayPalAdv" target="iframePayPalAdv">
  <input type="hidden" name="SECURETOKEN" value="">
  <input type="hidden" name="SECURETOKENID" value="" >
</form>
<script language="javascript" type="text/javascript">
	function openPayPalAdv(strToken, strTokenId) {
		var elt = document.getElementById("divPayPalAdv");

		//document.getElementById("iframePayPalAdv").src = "https://payflowlink.paypal.com/?SECURETOKEN=" + strToken + "&SECURETOKENID=" + strTokenId;
		document.getElementById("frmPayPalAdv").SECURETOKEN.value = strToken;
		document.getElementById("frmPayPalAdv").SECURETOKENID.value = strTokenId;
		document.getElementById("frmPayPalAdv").submit();

		elt.style.display = 'block';
	}
	function checkoutSwitch(bolHide) {
		if (document.getElementById("spanCheckout")) {
			if (bolHide)
				document.getElementById("spanCheckout").style.display = 'none';
			else
				document.getElementById("spanCheckout").style.display = 'block';
		}
	}
</script> 
<!--END: paypaladvance--> 

<!--START: kount-->
<iframe width="1" height="1" frameborder="0" scrolling="no" src="/logo_k.htm?m=[kount_merchantid]&s=[kount_sessionid]"> <img width=1 height=1 src="/logo_k.gif?m=[kount_merchantid]&s=[kount_sessionid]"> </iframe>
<!--END: kount-->

<input type="hidden" name="hdnAddrressValidatorResult" id="hdnAddrressValidatorResult" value="" />
<div id="divAddrressValidator" style="display:none;"> 
  <!--START: AddressValidatorBlock-->
  <div style="background-color: White; padding: 30px; -webkit-box-shadow: 0px 0px 12px rgba(50, 50, 50, 0.5); -moz-box-shadow: 0px 0px 12px rgba(50, 50, 50, 0.5); box-shadow: 0px 0px 12px rgba(50, 50, 50, 0.5);"> 
    <!--START: AddressValidatorBlock_ValidationFailed-->
    <div>[result_msg]</div>
    <!--END: AddressValidatorBlock_ValidationFailed--> 
    <!--START: AddressValidatorBlock_ValidationSuggestion-->
    <div> [result_msg] 
      <!--START: AddressValidatorBlock_ValidationSuggestion_SingleAddressBlock--> 
      <br />
      <br />
      <strong>[checkout1_AddressValidator_SuggestedAddress]</strong> <a style="text-decoration:underline;" href="#" onclick="javascript:selectAddress('[AddrressValidator_address1]', '[AddrressValidator_address2]', '[AddrressValidator_city]', '[AddrressValidator_state]', '[AddrressValidator_zip]', '[AddrressValidator_addresstype]', '[AddrressValidator_rdi]');">[AddrressValidator_address], [AddrressValidator_city], [AddrressValidator_state], [AddrressValidator_zip]</a> 
      <!--END: AddressValidatorBlock_ValidationSuggestion_SingleAddressBlock--> 
    </div>
    <!--END: AddressValidatorBlock_ValidationSuggestion--> 
    <!--START: AddressValidatorBlock_ValidationSuggestion_ContinueWithEnteredAddress--> 
    <br />
    <a style="text-decoration:underline;" href="javascript:void(0);" onclick="javascript:addressValidatorContinue('[AddrressValidator_addresstype]');">[checkout1_AddressValidator_Continue]</a> <br />
    <!--END: AddressValidatorBlock_ValidationSuggestion_ContinueWithEnteredAddress--> 
    <br />
    <a style="text-decoration:underline;" href="javascript:void(0);" onclick="javascript:closeAddressValidatorModal();">[checkout1_AddressValidator_Close]</a></div>
  <!--END: AddressValidatorBlock--> 
</div>

<!--START: VME_SELECTED_SCRIPT--> 
<script>
	function add_vme_overlay(panel)
	{
		var objBody = getElementById_s(panel);
		var objOverlay = document.createElement("div");
		
		objOverlay.setAttribute('id','overlay_'+panel);	
		objOverlay.className='overlay';
		objOverlay.style.position = 'absolute';
		objOverlay.style.textAlign = 'center';
		objOverlay.style.width = objBody.clientWidth+"px";
		objOverlay.style.height = objBody.clientHeight+"px";
		objBody.insertBefore(objOverlay, objBody.firstChild);
		objOverlay.style.display = 'block';

		get_Element('overlay_'+panel).innerHTML = '<table border=\"0\" width=\"100%\"><tr><td style=\"text-align: left;\"><div style=\"margin:10px 0px 0px 0px;\"><img src=\"assets/templates/common/images/vme_accpt_mark.png\"></div></td></tr></table>';
	} 	
	add_vme_overlay("billing_info2");
	add_vme_overlay("billing_info2");
	add_vme_overlay("billing_info2");
	add_vme_overlay("billing_info2");
</script> 
<!--END: VME_SELECTED_SCRIPT-->